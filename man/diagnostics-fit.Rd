% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/crossvalidation.R
\name{diagnostics-fit}
\alias{diagnostics-fit}
\alias{cve}
\alias{cv}
\alias{loocve}
\alias{rt}
\alias{cp}
\title{Diagnostics and goodness of fit of filtered series}
\usage{
cve(x, coef, ...)

cv(x, coef, ...)

loocve(x, coef, ...)

rt(x, coef, ...)

cp(x, coef, var, ...)
}
\arguments{
\item{x}{input time series.}

\item{coef}{vector of coefficients or a moving-average (\code{\link[=moving_average]{moving_average()}}).}

\item{...}{other arguments passed to the function \code{\link[=moving_average]{moving_average()}} to convert \code{coef} to a \code{"moving_average"} object.}

\item{var}{variance used to compute the CP statistic (\code{cp()}).}
}
\description{
Set of functions to compute diagnostics and goodness of fit of filtered series:
cross validation (\code{cv()}) and cross validate estimate (\code{cve()}),
leave-one-out cross validation estimate (\code{loocve}),
CP statistic (\code{cp()}) and Rice's T statistics (\code{rt()}).
}
\details{
Let \eqn{(\theta_i)_{-p\leq i \leq q}} be a moving average of length \eqn{p+q+1} used
to filter a time series \eqn{(y_i)_{1\leq i \leq n}}.
Let denote \eqn{\hat{\mu}_t} the filtered series computed at time \eqn{t} as:
\deqn{
\hat{\mu}_t = \sum_{i=-p}^q \theta_i y_{t+i}.
}

The cross validation estimate (\code{cve()}) is defined as the time series \eqn{Y_t-\hat{\mu}_{-t}} where
\eqn{\hat{\mu}_{-t}} is the leave-one-out cross validation estimate (\code{loocve()}) defined as the filtered series
computed deleting the observation \eqn{t} and remaining all the other points.
The cross validation statistics (\code{cv()}) is defined as:
\deqn{
CV=\frac{1}{n-(p+q)}
\sum_{t=p+1}^{n-q} \left(y_t - \hat{\mu}_{-t}\right)^2.
}
In the case of filtering with a moving average, we can show that:
\deqn{
\hat{\mu}_{-t}= \frac{\hat{\mu}_t - \theta_0 y_t}{1-\theta_0}
}
and
\deqn{
CV=\frac{1}{n-(p+q)}
\sum_{t=p+1}^{n-q} \left(\frac{y_t - \hat{\mu}_{t}}{1-\theta_0}\right)^2.
}

In the case of filtering with a moving average,
the CP estimate of risk (introduced by Mallows (1973); \code{cp()}) can be defined as:
\deqn{
CP=\frac{1}{\sigma^2}
\sum_{t=p+1}^{n-q} \left(y_t - \hat{\mu}_{t}\right)^2
-(n-(p+q))(1-2\theta_0).
}
The CP method requires an estimate of \eqn{\sigma^2} (\code{var} parameter).
The usual use of CP is to compare several different fits (for example different bandwidths):
one should use the same estimate of \eqn{\hat{\sigma}^2} for all fits (using for example \code{\link[=var_estimator]{var_estimator()}}).
The recommendation of Cleveland and Devlin (1988) is to compute \eqn{\hat{\sigma}^2}
from a fit at the smallest bandwidth under consideration,
at which one should be willing to assume that bias is negligible.

The Rice's T statistic (\code{rt()}) is defined as:
\deqn{
\frac{1}{n-(p+q)}
\sum_{t=p+1}^{n-q}
\frac{
  \left(y_t - \hat{\mu}_{t}\right)^2
}{
  1-2\theta_0
}
}
}
\references{
Loader, Clive. 1999.
Local regression and likelihood.
New York: Springer-Verlag.

Mallows, C. L. (1973). Some comments on Cp.
Technometrics 15, 661– 675.

Cleveland, W. S. and S. J. Devlin (1988).
Locally weighted regression: An approach to regression analysis by local fitting.
Journal of the American Statistical Association 83, 596–610.
}
